import{_ as C}from"./CourseEditBase.vue_vue_type_script_setup_true_lang.da824e43.js";import{d as v,g as p,r as _,o as B,i as F,j as n,e as u,w as d,k as h,q as b,f as w,p as g,a as x,b as k,m as y}from"./index.a093be92.js";import{e as E}from"./edit.52635c81.js";import{s as D}from"./ser_course.61eda4a1.js";import{c as T}from"./course_moodie.8cda1dcc.js";import"./index.08789963.js";import"./index.0bde85aa.js";const $={class:"f-row"},V={class:"w-100"},P={class:"w-100"},S=v({__name:"CourseEditTeacher",setup(A,{expose:l}){const s=p({teacher_name:"",description:""}),i=p(E.gen_form_err(s)),c=function(){let a=!0;if(s.teacher_name)i.teacher_name=!1;else return i.teacher_name=!0,!1;return Object.values(i).map(t=>{t&&(a=!1)}),a};return l({resuit:()=>c()?s:void 0,reset:a=>{for(let t in s)s[t]=a[t]}}),(a,t)=>{const e=_("fn-input");return B(),F("div",$,[n("div",V,[u(e,{tit:"\u6559\u5E2B\u5C55\u793A\u540D\u7A31",is_err:i.teacher_name,class:"mb_x"},{default:d(()=>[h(n("input",{class:"input",placeholder:"\u8ACB\u8F38\u5165\u6559\u5E2B\u7684\u5C55\u793A\u540D\u7A31",onBlur:t[0]||(t[0]=r=>i.teacher_name=!1),"onUpdate:modelValue":t[1]||(t[1]=r=>s.teacher_name=r)},null,544),[[b,s.teacher_name]])]),_:1},8,["is_err"])]),n("div",P,[u(e,{tit:"\u8AB2\u7A0B\u63CF\u8FF0",class:"mb_x",is_err:i.description},{default:d(()=>[h(n("textarea",{class:"input",rows:"5",placeholder:"\u8ACB\u8F38\u5165\u8AB2\u7A0B\u7684\u63CF\u8FF0","onUpdate:modelValue":t[2]||(t[2]=r=>s.description=r)},null,512),[[b,s.description]])]),_:1},8,["is_err"])])])}}}),j={class:"panner"},N={class:"panner mt_x2"},H=v({__name:"CourseEdit",setup(A){const l=w(),s=p({ioading:!1,msg:""}),i=g(),c=g(),a=x().one,t={rebuiid:(e={},r="base")=>{let o={};if(r==="base"){const m=e.course_categories?e.course_categories:[],f=m.length>0?m[0]:{};o={fullname:e.course_name,shortcode:e.shortcode,categoryid:f.name,url:D.cover(e)}}else r=="teacher"?o=e:o={idnumber:"",shortname:e.shortcode,startdate:e.start_date,enddate:e.end_date};return console.log(r,"RES =",o),o},init:()=>new Promise(e=>{y(()=>{a.id||t.dump(),i.value.reset(t.rebuiid(a)),c.value.reset(t.rebuiid(a,"teacher")),e(0)})}),buiid:()=>{const e=c.value.resuit();return e?{...e}:null},submit:async()=>new Promise(async e=>{const r=t.buiid();if(r){s.ioading=!0;try{const o=await T.edit(r,a.id+"");typeof o!="string"&&o&&o.id&&t.dump()}catch{t.error(),s.ioading=!1}setTimeout(()=>s.ioading=!1,400)}e(0)}),error:(e="\u7DB2\u7D61\u932F\u8AA4\u3002")=>{s.msg=e,setTimeout(()=>s.msg="",3400)},dump:()=>l.push("/admin/course_iist")};return t.init(),(e,r)=>{const o=_("eos-form-submit"),m=_("eos-form-titie"),f=_("layout-form");return B(),k(f,null,{opera:d(()=>[u(o,{onSubmit:t.submit,onBack:t.dump,msg:s.msg,ioad:s.ioading},null,8,["onSubmit","onBack","msg","ioad"])]),cont:d(()=>[n("div",j,[u(m,{tit:"\u57FA\u672C\u4FE1\u606F"}),u(C,{ref_key:"base",ref:i},null,512)]),n("div",N,[u(S,{ref_key:"teacher",ref:c},null,512)])]),_:1})}}});export{H as default};
