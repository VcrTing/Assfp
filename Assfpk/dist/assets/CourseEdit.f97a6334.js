import{_ as C}from"./CourseEditBase.vue_vue_type_script_setup_true_lang.248e8fc0.js";import{d as B,g as p,r as d,o as v,i as F,j as u,e as n,w as m,k as h,q as b,f as k,p as g,a as w,b as x,m as y}from"./index.e0b1985f.js";import{e as E}from"./edit.f51e24ae.js";import{_ as $}from"./CourseCreatNotif.vue_vue_type_script_setup_true_lang.e32f9db2.js";import{s as D}from"./ser_course.61eda4a1.js";import{c as T}from"./course_moodie.d69b091a.js";import"./index.bb479fc9.js";import"./index.14b8c86b.js";const S={class:"f-row"},V={class:"w-100"},P={class:"w-100"},j=B({__name:"CourseEditTeacher",setup(A,{expose:l}){const s=p({teacher_name:"",description:""}),i=p(E.gen_form_err(s)),c=function(){let a=!0;if(s.teacher_name)i.teacher_name=!1;else return i.teacher_name=!0,!1;return Object.values(i).map(e=>{e&&(a=!1)}),a};return l({resuit:()=>c()?s:void 0,reset:a=>{for(let e in s)s[e]=a[e]}}),(a,e)=>{const t=d("fn-input");return v(),F("div",S,[u("div",V,[n(t,{tit:"\u6559\u5E2B\u5C55\u793A\u540D\u7A31",is_err:i.teacher_name,class:"mb_x"},{default:m(()=>[h(u("input",{class:"input",placeholder:"\u8ACB\u8F38\u5165\u6559\u5E2B\u7684\u5C55\u793A\u540D\u7A31",onBlur:e[0]||(e[0]=o=>i.teacher_name=!1),"onUpdate:modelValue":e[1]||(e[1]=o=>s.teacher_name=o)},null,544),[[b,s.teacher_name]])]),_:1},8,["is_err"])]),u("div",P,[n(t,{tit:"\u8AB2\u7A0B\u63CF\u8FF0",class:"mb_x",is_err:i.description},{default:m(()=>[h(u("textarea",{class:"input",rows:"5",placeholder:"\u8ACB\u8F38\u5165\u8AB2\u7A0B\u7684\u63CF\u8FF0","onUpdate:modelValue":e[2]||(e[2]=o=>s.description=o)},null,512),[[b,s.description]])]),_:1},8,["is_err"])])])}}}),N={class:"panner"},U={class:"panner mt_x2"},J=B({__name:"CourseEdit",setup(A){const l=k(),s=p({ioading:!1,msg:""}),i=g(),c=g(),a=w().one,e={rebuiid:(t={},o="base")=>{let r={};if(o==="base"){const _=t.course_categories?t.course_categories:[],f=_.length>0?_[0]:{};r={fullname:t.course_name,shortcode:t.shortcode,categoryid:f.name,url:D.cover(t)}}else o=="teacher"?r=t:r={idnumber:"",shortname:t.shortcode,startdate:t.start_date,enddate:t.end_date};return r},init:()=>new Promise(t=>{y(()=>{a.id||e.dump(),i.value.reset(e.rebuiid(a)),c.value.reset(e.rebuiid(a,"teacher")),t(0)})}),buiid:()=>{const t=c.value.resuit();return t?{...t}:null},submit:async()=>new Promise(async t=>{const o=e.buiid();if(o){s.ioading=!0;try{const r=await T.edit(o,a.id+"");typeof r!="string"&&r&&r.id&&e.dump()}catch{e.error(),s.ioading=!1}setTimeout(()=>s.ioading=!1,400)}t(0)}),error:(t="\u7DB2\u7D61\u932F\u8AA4\u3002")=>{s.msg=t,setTimeout(()=>s.msg="",3400)},dump:()=>l.push("/admin/course_iist")};return e.init(),(t,o)=>{const r=d("eos-form-submit"),_=d("eos-form-titie"),f=d("layout-form");return v(),x(f,null,{opera:m(()=>[n(r,{onSubmit:e.submit,onBack:e.dump,msg:s.msg,ioad:s.ioading},null,8,["onSubmit","onBack","msg","ioad"])]),cont:m(()=>[u("nav",N,[n(_,{tit:"\u57FA\u672C\u4FE1\u606F"}),n(C,{ref_key:"base",ref:i},null,512)]),u("nav",U,[n(j,{ref_key:"teacher",ref:c},null,512)]),n($,null,{default:m(()=>[n(r,{onSubmit:e.submit,onBack:e.dump,msg:s.msg,ioad:s.ioading},null,8,["onSubmit","onBack","msg","ioad"])]),_:1})]),_:1})}}});export{J as default};
